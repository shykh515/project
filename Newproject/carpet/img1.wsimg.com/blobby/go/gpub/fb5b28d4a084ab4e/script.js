!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=17)}([function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t){e.exports=React},function(e,t){e.exports=PropTypes},function(e,t,n){var r=n(15);function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=i?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(n,o,l):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(19);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(15),a=n(16);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?a(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){e.exports=_},function(e,t){e.exports=Core},function(e,t,n){"use strict";var r=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,r(n(20)).default)({REVIEWS_SECTION_TITLE_RENDERED:null,REVIEWS_NO_DATA_RENDERED:null,REVIEWS_NOT_CONNECTED_MSG:null,PENDING_VALIDATION_HEADER:null,PENDING_VALIDATION_CONTENT:null,WAITING_FOR_DATA_HEADER:null,WAITING_FOR_DATA_CONTENT:null,SECTION_BACKGROUND:null,REVIEWS_BUSINESS_NAME_RENDERED:null,REVIEWS_CONNECT_BUTTON:null,USER_REVIEW_RENDERED:null,STATIC_REVIEW_RENDERED:null,READ_MORE_RENDERED:null,PRODUCT_LINK_RENDERED:null,REVIEW_TITLE_RENDERED:null,REVIEWER_INFO_RENDERED:null,REVIEWER_INITIAL_RENDERED:null,REVIEWER_PHOTO_RENDERED:null,RECOMMENDATION_RENDERED:null,RECOMMENDATION_ICON_RENDERED:null,RECOMMENDATION_TEXT_RENDERED:null,RECOMMENDATION_DESC_RENDERED:null,RATING_RENDERED:null,LEFT_ARROW_RENDERED:null,RIGHT_ARROW_RENDERED:null,UPGRADE_TIER_MSG:null,REVIEWS_LOADER:null});t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_REVIEWS_COUNT=t.getRootDomain=t.getConnectStatusUrl=t.getApiUrl=t.UpgradeURLTemplate=t.ConnectURLTemplate=t.ArrowType=t.ENV_CONFIG=t.STATES=t.ProviderUrls=t.ProviderPhotoUrls=t.ProviderName=t.RecommendationStrings=t.RecommendationIcons=t.ProviderSource=t.ProviderAlternateIcon=t.ProviderIcon=t.ProviderConnectDataEvents=t.Providers=void 0;var r={FACEBOOK:"facebook",YELP:"yelp",GMB:"gmb",YOTPO:"yotpo",MANUAL:"manual"};t.Providers=r;t.ProviderConnectDataEvents={facebook:"REVIEWS_FB_CONNECT_CLICKED",yelp:"REVIEWS_YELP_CONNECT_CLICKED",gmb:"REVIEWS_GMB_CONNECT_CLICKED",yotpo:"REVIEWS_YOTPO_CONNECT_CLICKED"};t.ProviderIcon={facebook:"facebook2",yelp:"yelpLogoNegative",gmb:"gmb",yotpo:"yotpo"};t.ProviderAlternateIcon={facebook:"facebook",yelp:"yelpLogoNegative",gmb:"gmb",yotpo:"yotpo"};var a={facebook:"fb",yelp:"yelp",gmb:"gmb",yotpo:"yotpo"};t.ProviderSource=a;t.RecommendationIcons={positive:"fbRecommends",negative:"fbDoesNotRecommend"};t.RecommendationStrings={positive:"recommends",negative:"doesNotRecommend"};t.ProviderName={facebook:"Facebook",gmb:"Google My Business",yelp:"Yelp",yotpo:"Yotpo"};t.ProviderPhotoUrls={facebook:"https://graph.facebook.com/v3.0/{id}/picture?height=100&width=100"};t.ProviderUrls={base:{facebook:"https://facebook.com",gmb:"https://maps.google.com",yelp:"https://www.yelp.com/biz"},photo:{facebook:"https://graph.facebook.com/v3.0/{id}/picture"}};t.STATES={NOT_SETUP:"NOT_SETUP",LOADING:"LOADING",HAS_REVIEWS:"HAS_REVIEWS",FAILED:"FAILED",NO_REVIEWS:"NO_REVIEWS",CONNECTED:"CONNECTED",NOT_CONNECTED:"NOT_CONNECTED"};var i={reseller:{local:"dev-secureserver.net",development:"dev-secureserver.net",test:"test-secureserver.net",production:"secureserver.net"},godaddy:{local:"dev-godaddy.com",development:"dev-godaddy.com",test:"test-godaddy.com",production:"godaddy.com"}};t.ENV_CONFIG=i;t.ArrowType={LEFT:"LEFT",RIGHT:"RIGHT"};t.ConnectURLTemplate={facebook:"https://dashboard.{rootDomain}/fbPageCreate/{accountId}?home={home}",gmb:"https://dashboard.{rootDomain}/account/{accountId}/gmb",yelp:"https://dashboard.{rootDomain}/account/{accountId}/yelp",yotpo:"https://{websiteId}.onlinestore.{rootDomain}/admin/general_settings/edit#reviews"};t.UpgradeURLTemplate={yotpo:"https://launch.{rootDomain}/?account_uid={accountId}&path=plans"};t.getApiUrl=function(e,t,n){return n===r.YOTPO?"https://proxy.apps-api.instantpage.".concat(i.reseller[e],"/v1/proxy/yotpo?websiteId=").concat(t):"https://proxy.apps-api.instantpage.".concat(i.reseller[e],"/v1/proxy/stats?id=").concat(t,"&source=").concat(a[n])};t.getConnectStatusUrl=function(e,t,n){var r=n?i.reseller[e]:i.godaddy[e];return"https://proxy.apps-api.instantpage.".concat(r,"/v1/proxy/social?accountId=").concat(t)};t.getRootDomain=function(e,t){return(t?i.reseller:i.godaddy)[e]};t.MAX_REVIEWS_COUNT=9},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){"use strict";window.wsb=window.wsb||{},window.wsb.ReviewsWidget=window.wsb.ReviewsWidget||n(18)},function(e,t,n){"use strict";var r=n(3),a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(4)),o=a(n(5)),l=a(n(6)),s=a(n(7)),c=a(n(8)),d=a(n(9)),u=a(n(10)),p=r(n(1)),f=a(n(2)),E=n(11),m=n(12),v=a(n(13)),g=a(n(21)),h=a(n(22)),y=n(14),R=n(25),T=n(26);function O(e){return function(){var t,n=(0,u.default)(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var r=(0,u.default)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)}}var b=m.UX.MatchMedia,w=m.UX.IntersectionObserver,C=3,P=2,S=y.MAX_REVIEWS_COUNT,D=y.Providers.FACEBOOK,N=[y.Providers.GMB,y.Providers.YELP],I=[y.Providers.YOTPO],_={small:430,medium:440,large:460,xlarge:480},x={container:{textAlign:"center",display:"flex",flexDirection:"column"},cardsContainer:{position:"relative"},arrow:{width:"medium",position:"absolute",top:"50%",zIndex:1,cursor:"pointer",color:"section",":hover":{color:"rgba(288, 288, 288, 0.6)"}},grid:{alignItems:"center",justifyContent:"center",flexWrap:"nowrap"},cell:{flexGrow:0},paginationContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:"xlarge"},pageDot:{width:"12px",height:"12px",borderRadius:"50%",margin:"xsmall",cursor:"pointer",backgroundColor:"sectionContrast",opacity:.6,boxShadow:"1px 2px 15px 0 rgba(0,0,0,0.18)"},selected:{opacity:1}},k=function(e){(0,c.default)(n,e);var t=O(n);function n(){var e;return(0,l.default)(this,n),(e=t.apply(this,arguments)).inView=function(){e.setState({visible:!0})},e.handleMatchMedia=function(t){var n=e.props,r=n.viewDevice,a=n.renderMode===m.constants.renderModes.PUBLISH?"xs"===t.size||"sm"===t.size:/mobile/i.test(r),i=C;a?i=1:"md"===t.size&&(i=P),e.setState({isMobile:a,cardsPerPage:i,size:t.size})},e.state={data:{},currentPage:1,pages:0,provider:D,state:y.STATES.LOADING,isMobile:!1,cardsPerPage:C,dummyData:!1,planUpgradeRequired:!1,visible:!1},e}return(0,s.default)(n,[{key:"updateCurrentPage",value:function(e){var t=this;return function(){t.setState({currentPage:e})}}},{key:"gotoPage",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(){var n=e.state,r=n.currentPage,a=n.pages,i=r+(t?1:-1);t?i>a&&(i=1):i<1&&(i=a),e.setState({currentPage:i})}}},{key:"getPageDotStyles",value:function(e){var t=this.state.currentPage,n=x.pageDot;return t===e&&(n=(0,E.merge)({},x.pageDot,x.selected)),n}},{key:"fetchData",value:function(){var e=this,t=this.props,n=t.renderMode,r=t.providerType,a=t.planType,i=t.sourceType,o=t.manualReviews,l=t.staticContent;if(i===R.SOURCE_TYPES.STATIC)if(o.length){var s=(0,T.getMappedManualReviews)(o,l.anonymous);this.setState({data:s,state:y.STATES.HAS_REVIEWS}),this.updatePageCount(s)}else this.setState({state:y.STATES.NO_REVIEWS});else if(I.includes(r)&&"commerce"!==a)this.setState({planUpgradeRequired:!0,state:y.STATES.NOT_SETUP});else{this.setState({planUpgradeRequired:!1,state:y.STATES.LOADING});var c=this.getProvider();this.fetchDataForProviders(function(t){t?(e.setState({data:t,state:y.STATES.HAS_REVIEWS}),e.updatePageCount(t)):n===m.constants.renderModes.EDIT&&N.includes(c)&&e.checkConnectStatusForProvider(c)})}}},{key:"fetchDataForProviders",value:function(e){var t=this,n=this.props,r=n.websiteId,a=n.env,i=this.getProvider(),o=(0,y.getApiUrl)(a,r,i);if("production"!==String(a)){var l=window.location.search.indexOf("dummy=true");l>=0?(o="".concat(o,"&").concat(window.location.search.substring(l)),this.setState({dummyData:!0})):this.setState({dummyData:!1})}if("undefined"!=typeof XMLHttpRequest){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status){var n=JSON.parse(s.responseText);return n.updateDate?(t.setState({providerState:y.STATES.CONNECTED}),0===n.reviews.length?(t.setState({state:y.STATES.NO_REVIEWS}),void e(null)):(t.setState({state:y.STATES.HAS_REVIEWS}),void e(n))):(t.setState({state:y.STATES.NOT_SETUP,providerState:n.connected?y.STATES.CONNECTED:y.STATES.NOT_CONNECTED}),void e(null))}t.setState({state:y.STATES.FAILED})}e(null)},s.open("GET",o,!0),s.send()}}},{key:"checkConnectStatusForProvider",value:function(e){var t=this,n=this.props,r=n.accountId,a=n.env,i=n.isReseller;if("production"!==a&&this.state.dummyData)this.setState({providerState:y.STATES.CONNECTED});else{var o=(0,y.getConnectStatusUrl)(a,r,i);if("undefined"!=typeof XMLHttpRequest){var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4===l.readyState&&200===l.status){var n=JSON.parse(l.responseText);t.setConnectStatus(n,e)}},l.open("GET",o,!0),l.withCredentials=!0,l.send(null)}}}},{key:"setConnectStatus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.Providers.GMB,n=e&&e[t];if(n){var r=Object.keys(n)&&Object.keys(n)[0]||null,a=r&&n[r]&&n[r].status||y.STATES.NOT_CONNECTED,i="PUBLISHED"===a?y.STATES.CONNECTED:a;this.setState({providerState:i})}else this.setState({providerState:y.STATES.NOT_CONNECTED})}},{key:"componentDidUpdate",value:function(e,t){(this.props.providerType!==e.providerType||this.props.sourceType!==e.sourceType||this.props.sourceType===R.SOURCE_TYPES.STATIC&&!(0,E.isEqual)(e.manualReviews,this.props.manualReviews)||this.state.cardsPerPage!==t.cardsPerPage)&&this.fetchData()}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"getProvider",value:function(){var e=this.props,t=e.sourceType,n=e.providerType;return t===R.SOURCE_TYPES.STATIC?y.Providers.MANUAL:n||D}},{key:"updatePageCount",value:function(e){var t=this.state.cardsPerPage,n=0,r=e.reviews.length>S?S:e.reviews.length;r&&(n=Math.floor(r/t),n+=r/t%1>0?1:0),this.setState({pages:n})}},{key:"getPageLink",value:function(e,t){if(t===y.Providers.MANUAL)return null;var n=y.ProviderUrls.base[t];return e&&e.metadata&&(e.metadata.pageId||e.metadata.link)&&(t===y.Providers.FACEBOOK?n="".concat(n,"/").concat(e.metadata.pageId,"/reviews"):t===y.Providers.GMB?n="".concat(n,"/maps?cid=").concat(e.metadata.pageId):t===y.Providers.YELP?n="".concat(n,"/").concat(e.metadata.pageId):t===y.Providers.YOTPO&&(n=e.metadata.link||"/")),n}},{key:"getCardHeight",value:function(){var e=this.context.fontScale;return _[e]}},{key:"renderMobileCards",value:function(e,t){var n=this.state,r=n.data,a=n.isMobile,i=this.props,o=i.renderMode,l=i.viewDevice,s=i.staticContent,c=i.market,d=i.sourceType;if(!r.reviews)return null;var u=o===m.constants.renderModes.PREVIEW&&"MOBILE_RENDER_DEVICE"===String(l)&&window.innerWidth>768,f=r.reviews.length>1,v="".concat(this.getCardHeight(),"px");return p.default.createElement(m.UX.Carousel,{slideHeight:v,viewportWidth:"100%",slideWidth:"290px",cellPadding:10,initialSlide:f?1:0,clickToNavigate:!1,infinite:f,dots:!1,arrows:!1,style:{slide:{opacity:"1",verticalAlign:"top"},selectedSlide:{opacity:"1"}}},(0,E.range)(r.reviews.length).map(function(n){return r.reviews&&r.reviews[n]&&p.default.createElement(h.default,{desktopMobilePreview:u,key:"mobile-review-card-".concat(n),data:r.reviews[n],provider:e,isMobile:a,market:c,staticContent:s,renderMode:o,link:t,sourceType:d,cardHeight:v})}))}},{key:"getCards",value:function(){var e=this,t=this.state,n=t.currentPage,r=t.data,a=t.isMobile,i=t.cardsPerPage,o=this.props,l=o.renderMode,s=o.staticContent,c=o.market,d=o.sourceType,u=this.getProvider(),f=n*i,v=this.getPageLink(r,u);return a?this.renderMobileCards(u,v):p.default.createElement(m.UX2.Component.Grid,{style:x.grid},(0,E.takeRight)([f-3,f-2,f-1],i).map(function(t){return r.reviews&&r.reviews[t]&&p.default.createElement(m.UX2.Component.Grid.Cell,{key:t,style:x.cell},p.default.createElement(h.default,{data:r.reviews[t],provider:u,isMobile:a,nextPageHandler:e.gotoPage(!0),previousPageHandler:e.gotoPage(!1),staticContent:s,market:c,renderMode:l,link:v,sourceType:d,cardHeight:"".concat(e.getCardHeight(),"px")}))}))}},{key:"getNavigationArrow",value:function(e){var t,n,r,a,i=this.props,o=i.hasBgImage,l=i.category,s=i.section;return e===y.ArrowType.RIGHT?(t=(0,E.merge)({},x.arrow,{right:"-35px"}),n=this.gotoPage(!0),r="chevronRight",a=v.default.RIGHT_ARROW_RENDERED):(t=(0,E.merge)({},x.arrow,{left:"-40px"}),n=this.gotoPage(!1),r="chevronLeft",a=v.default.LEFT_ARROW_RENDERED),p.default.createElement(m.UX2.Element.Block,{"data-aid":a,category:o?"accent":l,section:o?"overlay":s,onClick:n,style:t},p.default.createElement(m.UX2.Element.Icon,{icon:r}))}},{key:"getPaginationControl",value:function(){var e=this,t=this.state.pages;return t>1&&p.default.createElement(m.UX2.Element.Block,{style:x.paginationContainer},(0,E.range)(t).map(function(n){var r=n+1;return t>=r?p.default.createElement(m.UX2.Element.Block,{style:e.getPageDotStyles(r),onClick:e.updateCurrentPage(r)}):null}))}},{key:"getConnectProviderHandler",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(){var n=e.props,r=n.isReseller,a=n.env,i=n.accountId,o=n.websiteId,l=e.getProvider(),s=t?y.UpgradeURLTemplate:y.ConnectURLTemplate;window.location.href=s[l].replace("{rootDomain}",(0,y.getRootDomain)(a,r)).replace("{accountId}",i).replace("{websiteId}",o).replace("{home}",window.location.href)}}},{key:"renderMessageInContainer",value:function(e,t,n,r){if(!e)return null;var a={container:{display:"flex",flexDirection:"column",textAlign:"center",justifyContent:"center"},messageBlock:{paddingHorizontal:n?"xsmall":"xxlarge",paddingVertical:n?"large":"xlarger",margin:"auto",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",backgroundColor:"section"},icon:{width:"45px",height:"45px",marginBottom:"medium"}};return p.default.createElement(m.UX2.Element.Container,{style:a.container},p.default.createElement(m.UX2.Element.Text,{category:"accent",section:"overlay",style:a.messageBlock},p.default.createElement(m.UX2.Element.Block,null,p.default.createElement(m.UX2.Element.Icon,{icon:y.ProviderIcon[r],style:a.icon}),e)))}},{key:"displayNoReviewsMessage",value:function(){var e=this.state.isMobile,t=this.props,n=t.staticContent,r=t.hasBgImage,a=p.default.createElement(m.UX2.Element.Text,{style:{fontWeight:"bold"},children:n.comingSoon,"data-aid":v.default.REVIEWS_NO_DATA_RENDERED});return this.renderMessageInContainer(a,r,e,this.getProvider())}},{key:"displayMessages",value:function(e,t,n,r){var a=this.state.isMobile,i=this.props.hasBgImage,o=p.default.createElement(m.UX2.Element.Block,null,p.default.createElement(m.UX2.Element.Text,{style:{fontWeight:"bold"},children:e,"data-aid":n}),p.default.createElement(m.UX2.Element.Text,{style:{marginTop:"medium"},children:t,"data-aid":r}));return this.renderMessageInContainer(o,i,a,this.getProvider())}},{key:"displayPendingMessage",value:function(){var e=this.props.staticContent;return this.displayMessages(e.txtPendingValidation,e.gmb3Days,v.default.PENDING_VALIDATION_HEADER,v.default.PENDING_VALIDATION_CONTENT)}},{key:"displayWaitMessage",value:function(){var e=this.props.staticContent;return this.displayMessages(e.connectionSuccess,e.twentyFourHourLag,v.default.WAITING_FOR_DATA_HEADER,v.default.WAITING_FOR_DATA_CONTENT)}},{key:"displayConnectOrUpgradeMessage",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.props,r=n.staticContent,a=n.renderMode,i=n.publishDate,l=n.publishAfterLastUpgrade,s=this.getProvider(),c=N.concat(I).includes(s)&&(!i||l),d=y.ProviderName[s],u={renderMode:a,beforeContent:p.default.createElement(p.default.Fragment,null,p.default.createElement(m.UX2.Element.Icon,{icon:y.ProviderIcon[s],style:{width:"45px",height:"45px",marginBottom:"medium"}}),p.default.createElement(m.UX2.Element.Text,{typography:"none",children:r[t?"upgradeMessage":"connectMsg"].replace("{provider}",d),"data-aid":t?v.default.UPGRADE_TIER_MSG:v.default.REVIEWS_NOT_CONNECTED_MSG}),c&&p.default.createElement(m.UX2.Element.Block,{style:{marginTop:"medium"}},r.publishMessage.replace("{provider}",d))),button:(e={typography:"none",style:c?{opacity:"0.6",pointerEvents:"none"}:{opacity:"1"},onClick:t?this.getConnectProviderHandler(!0):this.getConnectProviderHandler(),children:r[t?"upgradeNow":"connectBtnText"].replace("{provider}",d)},(0,o.default)(e,"data-event",y.ProviderConnectDataEvents[s]),(0,o.default)(e,"data-aid",v.default.REVIEWS_CONNECT_BUTTON),e)};return p.default.createElement(m.UX2.Component.ZeroStateOverlay,u)}},{key:"renderReviews",value:function(){var e=this.state,t=e.data,n=e.isMobile,r=t.reviews&&t.reviews.length>this.state.cardsPerPage;return p.default.createElement(m.UX2.Element.Block,{style:x.container},p.default.createElement(m.UX2.Element.Block,{style:x.cardsContainer},!n&&r&&this.getNavigationArrow(y.ArrowType.LEFT),this.getCards(),!n&&r&&this.getNavigationArrow(y.ArrowType.RIGHT)),!n&&this.getPaginationControl())}},{key:"showWaitMessage",value:function(){var e=this.state,t=e.state,n=e.providerState,r=this.props,a=r.renderMode,i=r.gmbShowPendingMessage,o=r.fbPageId,l=this.getProvider();return a===m.constants.renderModes.EDIT&&t===y.STATES.NOT_SETUP&&(l===y.Providers.GMB?n===y.STATES.CONNECTED&&!i:l===y.Providers.FACEBOOK?!!o:(l===y.Providers.YELP||l===y.Providers.YOTPO)&&n===y.STATES.CONNECTED)}},{key:"isProviderNotSetup",value:function(e){var t=this.state,n=t.providerState;return!t.planUpgradeRequired&&(N.concat(I).includes(e)?!(n===y.STATES.CONNECTED):e===y.Providers.FACEBOOK?!this.props.fbPageId:e!==y.Providers.MANUAL)}},{key:"providerHasReviews",value:function(e){var t=this.props.manualReviews;return e===y.Providers.MANUAL?t&&t.length:this.state.state===y.STATES.HAS_REVIEWS}},{key:"getContainerStyles",value:function(e,t){var n="50px";this.props.renderMode!==m.constants.renderModes.EDIT&&(n=e?"300px":"500px");var r={display:"flex",flexDirection:"column",minHeight:n};return t&&(r.padding="0",r.margin="0"),r}},{key:"displayReviewBar",value:function(e,t){var n=this.props,r=n.staticContent,a=n.hasBgImage,o=this.state,l=o.isMobile,s=o.data,c=o.state,d=s&&s.metadata&&s.metadata.name||"";return p.default.createElement(m.UX2.Element.Container,{style:e},p.default.createElement(g.default,(0,i.default)({},this.props,{hasBgImage:a,overallRating:s.overallRating||0,businessName:d,provider:t,staticContent:r,isMobile:l,pageLink:this.getPageLink(s,t),totalReviews:s.totalReviews||0,negativeRecommendations:s.negativeRecommendations||0,positiveRecommendations:s.positiveRecommendations||0})),c===y.STATES.LOADING?p.default.createElement(m.UX2.Element.Loader,{"data-aid":v.default.REVIEWS_LOADER,style:{margin:"0 auto"}}):this.renderReviews())}},{key:"render",value:function(){var e=this.state,t=e.isMobile,n=e.state,r=e.planUpgradeRequired,a=e.visible,i=this.props,o=i.hasBgImage,l=i.gmbShowPendingMessage,s=i.renderMode,c=i.category,d=i.section,u=this.getProvider(),f=this.providerHasReviews(u),E=this.isProviderNotSetup(u),v=l&&!f&&s===m.constants.renderModes.EDIT,g=n===y.STATES.NO_REVIEWS||s!==m.constants.renderModes.EDIT&&n===y.STATES.NOT_SETUP,h=this.getContainerStyles(g,t);return a?p.default.createElement(m.UX2.Element.Container,{category:o?"accent":c,section:o?"overlay":d,style:h,group:"Group"},p.default.createElement(b,{onChange:this.handleMatchMedia}),f&&this.displayReviewBar(h,u),r&&this.displayConnectOrUpgradeMessage(!0),this.showWaitMessage()&&this.displayWaitMessage(),g&&this.displayNoReviewsMessage(),!f&&E&&this.displayConnectOrUpgradeMessage(),v&&this.displayPendingMessage()):p.default.createElement(w,{callback:this.inView})}}]),n}(p.Component);k.propTypes={viewDevice:f.default.string.isRequired,renderMode:f.default.string.isRequired,websiteId:f.default.string.isRequired,accountId:f.default.string.isRequired,isReseller:f.default.bool.isRequired,env:f.default.string.isRequired,staticContent:f.default.object,hasBgImage:f.default.bool,publishDate:f.default.string,category:f.default.string,section:f.default.string,gmbShowPendingMessage:f.default.bool,providerType:f.default.string,fbPageId:f.default.string,planType:f.default.string,publishAfterLastUpgrade:f.default.bool,sourceType:f.default.string,manualReviews:f.default.array,market:f.default.string},k.contextTypes={fontScale:f.default.string};var M=k;t.default=M,e.exports=t.default},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){e.exports=keyMirror},function(e,t,n){"use strict";var r=n(3),a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(4)),o=a(n(5)),l=a(n(6)),s=a(n(7)),c=a(n(8)),d=a(n(9)),u=a(n(10)),p=r(n(1)),f=a(n(2)),E=n(12),m=n(14),v=a(n(13));function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,o.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function y(e){return function(){var t,n=(0,u.default)(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var r=(0,u.default)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)}}var R={color:"section"},T=[m.Providers.YOTPO],O=[m.Providers.MANUAL],b={topBar:{display:"flex",alignItems:"center",alignContent:"center",justifyContent:"center",cursor:"pointer",marginBottom:"large","@xs-only":{boxShadow:"none",justifyContent:"center"},"@sm":{justifyContent:"center"}},overallRating:{marginLeft:"small"},ratingStar:{backgroundColor:"transparent",marginHorizontal:"medium","@md":{marginHorizontal:"0px"}},overallRatingContainer:{display:"flex",flexDirection:"column",marginLeft:"small"},overallReviews:{lineHeight:"normal",marginTop:"xxsmall"},recommended:{fontWeight:"bold",lineHeight:"normal"},mobileTopBarContainer:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"0"},businessName:{marginBottom:"xxsmall",lineHeight:"normal"},pageLink:{display:"block",color:"section",":hover":R,":visited":R,textTransform:"none"},pageLinkContainer:{padding:"0",marginBottom:"medium",textAlign:"center"}},w=function(e){(0,c.default)(n,e);var t=y(n);function n(){return(0,l.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"generateReviewBarStyles",value:function(){var e=this.props.provider;return{linkProps:{tag:"a",target:T.includes(e)?"_self":"_blank",rel:T.includes(e)?"alternate":"noopener",style:{display:"block"}}}}},{key:"getBusinessNameBlock",value:function(){var e=this.props.businessName;return p.default.createElement(E.UX2.Element.Text.Major,{"data-aid":v.default.REVIEWS_BUSINESS_NAME_RENDERED,style:b.businessName,children:e})}},{key:"getRecommendationPercentage",value:function(){var e=this.props,t=e.positiveRecommendations,n=e.negativeRecommendations;return t>0?Math.ceil(100*t/(t+n)):0}},{key:"getMobileRatingBar",value:function(){var e=this.props,t=e.provider,n=e.overallRating,r=e.positiveRecommendations,a=e.staticContent,i=e.negativeRecommendations;if(t===m.Providers.FACEBOOK&&r>0){var o=this.getRecommendationPercentage(),l=r+i;return p.default.createElement(E.UX2.Element.Block,{"data-aid":v.default.RECOMMENDATION_RENDERED,style:h({},b.topBar,{},{flexDirection:"column"})},p.default.createElement(E.UX2.Element.Text.Major,{"data-aid":v.default.RECOMMENDATION_TEXT_RENDERED,style:b.recommended},a.percentRecommend.replace("{percent}","".concat(o,"%"))),p.default.createElement(E.UX2.Element.Text,{"data-aid":v.default.RECOMMENDATION_DESC_RENDERED,style:h({},b.overallReviews,{textAlign:"center",marginBottom:"small"})},1===l?a.basedOnOne:a.basedOn.replace("{reviewCount}",l)))}return p.default.createElement(E.UX2.Element.Block,{style:b.topBar},p.default.createElement(E.UX2.Element.Heading.Major,{style:b.overallRating},n.toFixed(1)),p.default.createElement(E.UX2.Component.Rating,{"data-aid":v.default.RATING_RENDERED,rating:n,style:b.ratingStar}))}},{key:"getDesktopRatingBar",value:function(){var e=this.props,t=e.provider,n=e.positiveRecommendations,r=e.negativeRecommendations,a=e.overallRating,i=e.totalReviews,o=e.staticContent,l=1===i?o.review:o.reviews;if(t===m.Providers.YOTPO&&(l=1===i?o.productReview:o.productReviews),t===m.Providers.FACEBOOK&&n>0){var s=this.getRecommendationPercentage(),c=n+r;return p.default.createElement(E.UX2.Element.Block,{"data-aid":v.default.RECOMMENDATION_RENDERED,style:b.overallRatingContainer},this.getBusinessNameBlock(),p.default.createElement(E.UX2.Element.Text.Major,{"data-aid":v.default.RECOMMENDATION_TEXT_RENDERED,style:b.recommended},o.percentRecommend.replace("{percent}","".concat(s,"%"))),p.default.createElement(E.UX2.Element.Text,{"data-aid":v.default.RECOMMENDATION_DESC_RENDERED,style:b.overallReviews},1===c?o.basedOnOne:o.basedOn.replace("{reviewCount}",c)))}return p.default.createElement(E.UX2.Element.Block,{style:b.overallRatingContainer},this.getBusinessNameBlock(),a>0&&p.default.createElement(E.UX2.Component.Rating,{"data-aid":v.default.RATING_RENDERED,rating:a,style:b.ratingStar}),p.default.createElement(E.UX2.Element.Text,{style:b.overallReviews},l.replace("{totalReviews}",i)))}},{key:"render",value:function(){var e=this.props,t=e.provider,n=e.overallRating,r=e.totalReviews,a=e.businessName,o=e.positiveRecommendations,l=e.negativeRecommendations,s=e.pageLink,c=e.staticContent,d=e.isMobile,u=e.hasBgImage,f=e.category,g=e.section;if(O.includes(t))return null;var h=this.generateReviewBarStyles();h.linkProps.href=s;var y=t===m.Providers.YOTPO?c.viewAllProductReviews:c.viewAllReviews,R=t===m.Providers.FACEBOOK&&o>0?o+l:r;return p.default.createElement(E.UX2.Element.Container,{category:u?"accent":f,section:u?"overlay":g},!d&&p.default.createElement(E.UX2.Element.Element,(0,i.default)({},h.linkProps,{style:{"text-decoration-line":"none"}}),p.default.createElement(E.UX2.Element.Block,{style:b.topBar},p.default.createElement(E.UX2.Element.Block,{style:{marginTop:"xxsmall"}},p.default.createElement(E.UX2.Element.Icon,{icon:m.ProviderIcon[t],size:"xlarge"})),t!==m.Providers.FACEBOOK&&n>0&&p.default.createElement(E.UX2.Element.Heading.Major,{style:b.overallRating},n.toFixed(1)),p.default.createElement(E.UX2.Element.Block,{style:b.overallRatingContainer},this.getDesktopRatingBar()))),d&&p.default.createElement(E.UX2.Element.Container,{style:b.mobileTopBarContainer},p.default.createElement(E.UX2.Element.Text.Major,{"data-aid":v.default.REVIEWS_BUSINESS_NAME_RENDERED,style:{marginBottom:"xxsmall",textAlign:"center"},children:a}),this.getMobileRatingBar(),p.default.createElement(E.UX2.Element.Container,{style:b.pageLinkContainer},p.default.createElement(E.UX2.Element.Element,{tag:"a",target:"_blank",href:s,style:b.pageLink},y.replace("{totalReviews}",1===R?"":R)))))}}]),n}(p.Component);w.propTypes={provider:f.default.string,overallRating:f.default.number,totalReviews:f.default.number,isMobile:f.default.bool,pageLink:f.default.string,staticContent:f.default.object.isRequired,hasBgImage:f.default.bool,businessName:f.default.string,category:f.default.string,section:f.default.string,positiveRecommendations:f.default.number,negativeRecommendations:f.default.number},w.defaultProps={provider:m.Providers.FACEBOOK,overallRating:0,totalReviews:0};var C=w;t.default=C,e.exports=t.default},function(e,t,n){"use strict";var r=n(3),a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(4)),o=a(n(6)),l=a(n(7)),s=a(n(16)),c=a(n(8)),d=a(n(9)),u=a(n(10)),p=a(n(5)),f=r(n(1)),E=a(n(23)),m=n(11),v=a(n(2)),g=n(12),h=n(14),y=a(n(24)),R=a(n(13));function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach(function(t){(0,p.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function b(e){return function(){var t,n=(0,u.default)(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var r=(0,u.default)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)}}var w=[h.Providers.YOTPO],C=240,P=240,S={common:{display:"flex",flexGrow:"1",flexShrink:"0",flexBasis:"auto",flexDirection:"column",alignItems:"center",justifyContent:"space-between"},topContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},photoContainer:{width:"100px",height:"100px",borderRadius:"50%",backgroundColor:"rgba(240,240,240,0.8)",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},photoStyles:{width:"100px",height:"100px",display:"inline-block"},firstInitial:{color:"#CBCBCB",lineHeight:"1",padding:"medium",fontSize:"xxxlarge"},reviewBodyContainer:{display:"flex",flexDirection:"column",justifyContent:"space-between",paddingHorizontal:"medium",paddingVertical:"medium",textTransform:"none",flexGrow:2,width:"100%"},reviewTitle:{marginBottom:"small",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"normal"},sharedReviewContent:{lineHeight:"1.3",minHeight:"42px"},reviewerContainer:(0,p.default)({paddingHorizontal:"medium",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},"@xs-only",{marginTop:"0"}),reviewer:{paddingHorizontal:"small",fontSize:"xsmall",lineHeight:"normal"},recommendationContainer:{paddingTop:"medium",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},icons:{facebook:{color:"#4267B2",height:"25px",width:"25px"},recommendation:{width:"20px"}},fullReview:(0,p.default)({position:"absolute",width:"100%",height:"100%",top:"100%",opacity:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"action",color:"action",padding:"small",transition:"all 0.3s ease"},"@md",{padding:"medium"}),fullReviewHover:(0,p.default)({overflow:"hidden"},"@md",{":hover":{".fullreview":{opacity:1,top:0,zIndex:1}}}),fullReviewClose:{position:"absolute",top:"16px",right:"16px",cursor:"pointer"},fullReviewOverlayShowOnMobile:{opacity:1,top:0,zIndex:1},linkContainer:{marginTop:"small"},ratingStars:(0,p.default)({marginTop:"medium"},"@xs-only",{marginTop:"small"})},D=[h.Providers.FACEBOOK,h.Providers.YELP,h.Providers.YOTPO],N=[h.Providers.MANUAL],I=[h.Providers.YOTPO],_=["positive","negative"],x=function(e){(0,c.default)(n,e);var t=b(n);function n(){var e;return(0,o.default)(this,n),(e=t.apply(this,arguments)).state={truncated:!1,imageFailed:!1,showFullReviewOverlay:!1,showExternalLink:!1},e.handleTruncate=e.handleTruncate.bind((0,s.default)(e)),e.toggleFullReviewOverlay=e.toggleFullReviewOverlay.bind((0,s.default)(e)),e.handleImageError=e.handleImageError.bind((0,s.default)(e)),e.getTotalReviewLines=e.getTotalReviewLines.bind((0,s.default)(e)),e.cardComponent=f.default.createRef(),e}return(0,l.default)(n,[{key:"handleTruncate",value:function(e){var t=this.props.provider;this.state.truncated!==e&&this.setState({truncated:e,showExternalLink:D.includes(t)})}},{key:"toggleFullReviewOverlay",value:function(){this.setState({showFullReviewOverlay:!this.state.showFullReviewOverlay})}},{key:"handleImageError",value:function(){this.setState({imageFailed:!0})}},{key:"getReviewerPhoto",value:function(e,t){var n,r,a=this.props.sourceType,o=this.state.imageFailed,l=(r=e.photo?e.photo:(n=e.imageData||{}).image||"")&&(r.toLowerCase().startsWith("http")||r.startsWith("//"))?r:null,s="dynamic"===a;e.metadata&&e.metadata.reviewerId&&h.ProviderPhotoUrls[t]&&(l=h.ProviderPhotoUrls[t].replace("{id}",e.metadata.reviewerId));var c=e.name?e.name.charAt(0).toUpperCase():null,d=s?{src:l}:{imageData:n,imageSrcCallback:function(e){return e?e.replace(/{width}/g,100).replace(/{height}/g,100):""}};return f.default.createElement(g.UX2.Element.Block,{style:S.photoContainer},l&&!o&&f.default.createElement(g.UX2.Element.Image.Thumbnail,(0,i.default)({tag:"img","data-aid":R.default.REVIEWER_PHOTO_RENDERED,style:S.photoStyles,onError:this.handleImageError},d)),(!l||o)&&c&&f.default.createElement(g.UX2.Element.Heading,{"data-aid":R.default.REVIEWER_INITIAL_RENDERED,children:c,style:S.firstInitial}))}},{key:"getRatingBlock",value:function(){var e=this.props,t=e.provider,n=e.data,r=e.staticContent,a=e.renderMode;if(t===h.Providers.FACEBOOK&&n.recommendation&&_.includes(n.recommendation))return f.default.createElement(g.UX2.Element.Block,{"data-aid":R.default.RECOMMENDATION_RENDERED,style:S.recommendationContainer},f.default.createElement(g.UX2.Element.Icon,{"data-aid":R.default.RECOMMENDATION_ICON_RENDERED,icon:h.RecommendationIcons[n.recommendation],style:S.icons.recommendation}),f.default.createElement(g.UX2.Element.Text,{"data-aid":R.default.RECOMMENDATION_TEXT_RENDERED,style:{paddingLeft:"small"}},r[h.RecommendationStrings[n.recommendation]]));var i=t===h.Providers.MANUAL&&a!==g.constants.renderModes.EDIT&&"0"===n.rating?"hidden":"visible";return f.default.createElement(g.UX2.Component.Rating,{"data-aid":R.default.RATING_RENDERED,style:O({},S.ratingStars,{visibility:i}),rating:n.rating})}},{key:"getTruncatedLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f.default.createElement(y.default,{lines:1,ellipsis:n?'..."':"...",trimWhitespace:!0,width:e?C:P},"".concat(t))}},{key:"sanitizeLink",value:function(e,t){return w.includes(t)||!e||e.startsWith("http")?e:"//".concat(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.data,n=e.data;t.photo===n.photo&&(0,m.get)(t,"imageData.image")===(0,m.get)(n,"imageData.image")||this.setState({imageFailed:!1})}},{key:"componentDidMount",value:function(){var e=this.cardComponent.current&&E.default.findDOMNode(this.cardComponent.current),t=e&&e.offsetWidth||0;this.setState({currentCardWidth:t})}},{key:"getTotalReviewLines",value:function(e){var t=this.props,n=t.isMobile,r=t.provider,a=this.state.currentCardWidth;if(n||!n&&e)return 3;var i=r===h.Providers.MANUAL?4:3;return a&&a<=300?2:i}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.provider,r=e.isMobile,a=e.desktopMobilePreview,i=e.link,o=e.staticContent,l=e.market,s=e.cardHeight,c=this.state,d=c.truncated,u=c.showExternalLink,E=c.showFullReviewOverlay,v=N.includes(n)&&(0,m.get)(t,"link",!1),T=d&&!(v||u),b=I.includes(n)&&!!(t&&t.metadata&&t.metadata.product),w=I.includes(n)?"0.6":"1",D=t&&t.metadata&&t.metadata.title||"",_=this.getTotalReviewLines(v),x={card:(0,p.default)({textAlign:"center",borderWidth:"0px",textShadow:"none",position:"relative",boxShadow:"2px 6px 30px 0 rgba(0,0,0,0.18)",paddingVertical:"large",height:s,width:"290px"},"@xs-only",{paddingVertical:"medium"})},k=T?S.fullReviewHover:{},M=E?S.fullReviewOverlayShowOnMobile:{};r&&(a||(x.card.minWidth="290px",x.card.width="auto"));var A=t.date&&!!Date.parse(t.date)&&new Date(t.date)||null;return f.default.createElement(g.UX2.Element.Block,null,f.default.createElement(g.UX2.Group.Card,{ref:this.cardComponent,style:O({},S.common,{},x.card,{},k)},T&&f.default.createElement(g.UX2.Element.Block,{style:O({},S.fullReview,{},M),className:"fullreview",category:"accent",section:"overlay"},r&&f.default.createElement(g.UX2.Element.Icon,{icon:"close",style:S.fullReviewClose,onClick:this.toggleFullReviewOverlay}),f.default.createElement(g.UX2.Element.Text,{children:t.body,style:O({color:"action"},S.sharedReviewContent)})),f.default.createElement(g.UX2.Element.Container,{style:S.topContainer},this.getReviewerPhoto(t,n),this.getRatingBlock()),f.default.createElement(g.UX2.Element.Block,{style:S.reviewBodyContainer},b&&f.default.createElement(g.UX2.Element.Link,{"data-aid":R.default.PRODUCT_LINK_RENDERED,target:"_self",href:this.sanitizeLink(t.link||i,n)},this.getTruncatedLine(r,t.metadata.product)),D&&f.default.createElement(g.UX2.Element.Heading,{"data-aid":R.default.REVIEW_TITLE_RENDERED,style:S.reviewTitle},D),t.body&&f.default.createElement(g.UX2.Element.Text,{style:O({},S.sharedReviewContent,{opacity:w}),featured:!0},f.default.createElement(y.default,{"data-aid":R.default.USER_REVIEW_RENDERED,lines:_,ellipsis:'..."',trimWhitespace:!0,width:r?C:P,onTruncate:this.handleTruncate},'"'.concat(t.body,'"'))),!t.body&&f.default.createElement(g.UX2.Element.Details,{"data-aid":R.default.STATIC_REVIEW_RENDERED},o.noWrittenReviews),f.default.createElement(g.UX2.Element.Block,{style:O({},S.linkContainer)},(v||u)&&f.default.createElement(g.UX2.Element.MoreLink.Forward,{"data-aid":R.default.READ_MORE_RENDERED,target:b?"_self":"_blank",href:this.sanitizeLink(t.link||i,n)},o.readFullReview),r&&d&&!(v||u)&&f.default.createElement(g.UX2.Element.Link,{tag:"span",onClick:this.toggleFullReviewOverlay,children:o.viewMore||"View More"}))),f.default.createElement(g.UX2.Element.Block,{style:S.reviewerContainer},f.default.createElement(g.UX2.Element.Icon,{icon:h.ProviderAlternateIcon[n],size:"medium",style:S.icons[n]}),f.default.createElement(g.UX2.Element.Details.Minor,{"data-aid":R.default.REVIEWER_INFO_RENDERED,tag:"p",style:S.reviewer},f.default.createElement("strong",null,t.name," ",t.name&&A?" - ":"")," ",A&&A.toLocaleDateString(l)||""))))}}]),n}(f.Component);x.propTypes={data:v.default.object.isRequired,provider:v.default.string.isRequired,link:v.default.string,isMobile:v.default.bool,nextPageHandler:v.default.func,previousPageHandler:v.default.func,desktopMobilePreview:v.default.bool,staticContent:v.default.object,renderMode:v.default.string.isRequired,market:v.default.string,sourceType:v.default.string,cardHeight:v.default.string};var k=x;t.default=k,e.exports=t.default},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n.n(r),i=n(2),o=n.n(i),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var c=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return i.state={},i.styles={ellipsis:{position:"fixed",visibility:"hidden",top:0,left:0}},i.elements={},i.onResize=i.onResize.bind(i),i.onTruncate=i.onTruncate.bind(i),i.calcTargetWidth=i.calcTargetWidth.bind(i),i.measureWidth=i.measureWidth.bind(i),i.getLines=i.getLines.bind(i),i.renderLine=i.renderLine.bind(i),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),s(t,[{key:"componentDidMount",value:function(){var e=this.elements.text,t=this.calcTargetWidth,n=this.onResize,r=document.createElement("canvas");this.canvasContext=r.getContext("2d"),t(function(){e&&e.parentNode.removeChild(e)}),window.addEventListener("resize",n)}},{key:"componentDidUpdate",value:function(e){this.props.children!==e.children&&this.forceUpdate(),this.props.width!==e.width&&this.calcTargetWidth()}},{key:"componentWillUnmount",value:function(){var e=this.elements.ellipsis,t=this.onResize,n=this.timeout;e.parentNode.removeChild(e),window.removeEventListener("resize",t),window.cancelAnimationFrame(n)}},{key:"innerText",value:function(e){var t=document.createElement("div"),n="innerText"in window.HTMLElement.prototype?"innerText":"textContent";t.innerHTML=e.innerHTML.replace(/\r\n|\r|\n/g," ");var r=t[n],a=document.createElement("div");return a.innerHTML="foo<br/>bar","foo\nbar"!==a[n].replace(/\r\n|\r/g,"\n")&&(t.innerHTML=t.innerHTML.replace(/<br.*?[\/]?>/gi,"\n"),r=t[n]),r}},{key:"onResize",value:function(){this.calcTargetWidth()}},{key:"onTruncate",value:function(e){var t=this.props.onTruncate;"function"==typeof t&&(this.timeout=window.requestAnimationFrame(function(){t(e)}))}},{key:"calcTargetWidth",value:function(e){var t=this.elements.target,n=this.calcTargetWidth,r=this.canvasContext,a=this.props.width;if(t){var i=a||Math.floor(t.parentNode.getBoundingClientRect().width);if(!i)return window.requestAnimationFrame(function(){return n(e)});var o=window.getComputedStyle(t),l=[o["font-weight"],o["font-style"],o["font-size"],o["font-family"]].join(" ");r.font=l,this.setState({targetWidth:i},e)}}},{key:"measureWidth",value:function(e){return this.canvasContext.measureText(e).width}},{key:"ellipsisWidth",value:function(e){return e.offsetWidth}},{key:"trimRight",value:function(e){return e.replace(/\s+$/,"")}},{key:"getLines",value:function(){for(var e=this.elements,t=this.props,n=t.lines,r=t.ellipsis,i=t.trimWhitespace,o=this.state.targetWidth,l=this.innerText,s=this.measureWidth,c=this.onTruncate,d=this.trimRight,u=[],p=l(e.text).split("\n").map(function(e){return e.split(" ")}),f=!0,E=this.ellipsisWidth(this.elements.ellipsis),m=1;m<=n;m++){var v=p[0];if(0!==v.length){var g=v.join(" ");if(s(g)<=o&&1===p.length){f=!1,u.push(g);break}if(m===n){for(var h=v.join(" "),y=0,R=h.length-1;y<=R;){var T=Math.floor((y+R)/2);s(h.slice(0,T+1))+E<=o?y=T+1:R=T-1}var O=h.slice(0,y);if(i)for(O=d(O);!O.length&&u.length;){O=d(u.pop())}g=a.a.createElement("span",null,O,r)}else{for(var b=0,w=v.length-1;b<=w;){var C=Math.floor((b+w)/2);s(v.slice(0,C+1).join(" "))<=o?b=C+1:w=C-1}if(0===b){m=n-1;continue}g=v.slice(0,b).join(" "),p[0].splice(0,b)}u.push(g)}else u.push(),p.shift(),m--}return c(f),u}},{key:"renderLine",value:function(e,t,n){if(t===n.length-1)return a.a.createElement("span",{key:t},e);var r=a.a.createElement("br",{key:t+"br"});return e?[a.a.createElement("span",{key:t},e),r]:r}},{key:"render",value:function(){var e=this,t=this.elements.target,n=this.props,r=n.children,i=n.ellipsis,o=n.lines,s=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(n,["children","ellipsis","lines"]),c=this.state.targetWidth,d=this.getLines,u=this.renderLine,p=this.onTruncate,f=void 0;return"undefined"!=typeof window&&!(!t||!c)&&(o>0?f=d().map(u):(f=r,p(!1))),delete s.onTruncate,delete s.trimWhitespace,a.a.createElement("span",l({},s,{ref:function(t){e.elements.target=t}}),a.a.createElement("span",null,f),a.a.createElement("span",{ref:function(t){e.elements.text=t}},r),a.a.createElement("span",{ref:function(t){e.elements.ellipsis=t},style:this.styles.ellipsis},i))}}]),t}();c.propTypes={children:o.a.node,ellipsis:o.a.node,lines:o.a.oneOfType([o.a.oneOf([!1]),o.a.number]),trimWhitespace:o.a.bool,width:o.a.number,onTruncate:o.a.func},c.defaultProps={children:"",ellipsis:"â€¦",lines:1,trimWhitespace:!1,width:0},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MANUAL_REVIEWS=t.SOURCE_TYPES=t.GMB_STATUS=t.WEBSITE_PROPERTIES=void 0;t.WEBSITE_PROPERTIES={GMB_STATUS_KEY:"gmbStatusResponse",API_RESPONSE_KEY:"apiRequestResponseData"};t.GMB_STATUS={PUBLISHED:"PUBLISHED",DUPLICATE:"DUPLICATE",PENDING:"PENDING",UNKNOWN:"UNKNOWN"};t.SOURCE_TYPES={DYNAMIC:"dynamic",STATIC:"static"};var r={ROUTE:"".concat("/reviews","/$"),PATH:"/reviews",PHOTO:"".concat("/reviews","/$/photo")};t.MANUAL_REVIEWS=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMappedManualReviews=void 0;var r=n(11);t.getMappedManualReviews=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Anonymous",n={totalReviews:e.length,reviews:[]};return e.length&&(0,r.each)(e,function(e){n.reviews.push({imageData:e.photo||{},name:e.name||t,date:e.date||"",rating:e.rating,body:e.body,link:e.link||null,metadata:{title:e.title}})}),n}}]);